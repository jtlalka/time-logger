<div id="history" data-ng-init="refresh()">
    <div data-header-directive="'History'"></div>

    <div class="history">
        <form name="historyForm" data-ng-submit="updateHistory()">
            <label>
                <input type="checkbox" data-ng-model="data.fromFlag" data-ng-change="clearFromData()" />
                <span>From:</span>
                <input type="date" class="date" placeholder="yyyy-mm-dd"
                        data-ng-model="data.fromDate"
                        data-ng-required="data.fromFlag"
                        data-ng-disabled="data.fromFlag === false" />
            </label>
            <label>
                <input type="checkbox" data-ng-model="data.toFlag" data-ng-change="clearToData()" />
                <span>To:</span>
                <input type="date" class="date" placeholder="yyyy-mm-dd"
                       data-ng-model="data.toDate"
                       data-ng-required="data.toFlag"
                       data-ng-disabled="data.toFlag === false" />
            </label>
            <label>
                <button type="submit"
                        data-ng-show="historyForm.$valid && historyForm.$dirty"
                        data-ng-disabled="historyForm.$invalid || historyForm.$pristine">Save</button>
            </label>
        </form>
        <div class="values">
            <div data-ng-repeat="day in history.daily | orderObjectBy:'date':true track by $index"
                    data-ng-show=":: day.active"
                    data-ng-click="openTooltip(day.date)">

                <div class="block-top">
                    <div class="block-left">
                        <span>{{:: day.date | date: 'dd-MM-yyyy'}}</span>
                    </div>
                    <div class="block-right">
                        <span class="time">{{:: (day.types || {}) | countWorkTime | timeFormat : 'positive'}}</span> /
                        <span class="overtime">{{:: (day.overTime || 0) | timeFormat : 'positive'}}</span>
                    </div>
                </div>

                <div class="progress-bar">
                    <span data-ng-repeat="(type, value) in day.types track by $index"
                          data-ng-class=":: type"
                          data-width-directive="value data.barSize"></span>
                </div>
            </div>
        </div>
    </div>

    <div class="overtime" data-ng-switch="history.timeFrame.overTime > 0">
        <span class="over" data-ng-switch-when="true">Total Over Time: {{history.timeFrame.overTime | timeFormat}}</span>
        <span class="todo" data-ng-switch-when="false">Total Missing Time: {{history.timeFrame.overTime | timeFormat}}</span>
    </div>

</div>
